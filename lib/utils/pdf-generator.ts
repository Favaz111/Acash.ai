import { jsPDF } from 'jspdf';
import { formatCurrency, formatNumber } from '@/lib/utils';

// ==========================================
// TYPE DEFINITIONS
// ==========================================

interface DebtReportData {
  // Inputs
  debtType: string;
  totalDebt: number;
  interestRate: number;
  monthlyPayment: number;

  // Results
  healthScore: number;
  years: number;
  remainingMonths: number;
  months: number;
  totalPaid: number;
  totalInterest: number;

  // Recommendations
  recommendations: Array<{
    title: string;
    description: string;
    impact: string;
    benefits: string[];
    actionable?: string;
  }>;

  // Simulations
  simulations: Array<{
    payment: number;
    savings: number;
    monthsSaved: number;
  }>;
}

interface BudgetReportData {
  monthlyIncome: number;
  monthlyExpenses: number;
  balance: number;
  status: 'surplus' | 'balanced' | 'deficit';
  balancePercentage: number;
  savingsRate: number;
  healthScore: number;
  recommendations: Array<{
    priority: 'high' | 'medium' | 'low';
    title: string;
    impact: string;
    benefits: string[];
  }>;
}

interface LoanReportData {
  principal: number;
  interestRate: number;
  termYears: number;
  monthlyPayment: number;
  totalPayment: number;
  totalInterest: number;
  amortizationSchedule?: Array<{
    month: number;
    payment: number;
    principal: number;
    interest: number;
    balance: number;
  }>;
}

export const generateDebtReportPDF = (data: DebtReportData) => {
  const doc = new jsPDF();

  // ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿÆÿ∑ ŸÑŸÑÿπÿ±ÿ®Ÿäÿ© (ŸÜÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿÆÿ∑ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä)
  doc.setFont('helvetica', 'normal');

  let yPos = 20;

  // ÿßŸÑÿπŸÜŸàÿßŸÜ
  doc.setFontSize(20);
  doc.text('Debt Repayment Report', 105, yPos, { align: 'center' });
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿ≥ÿØÿßÿØ ÿßŸÑÿØŸäŸàŸÜ', 105, yPos + 8, { align: 'center' });

  yPos += 25;

  // ÿßŸÑÿÆÿ∑ ÿßŸÑŸÅÿßÿµŸÑ
  doc.setLineWidth(0.5);
  doc.line(20, yPos, 190, yPos);
  yPos += 10;

  // ÿØÿ±ÿ¨ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ©
  doc.setFontSize(16);
  doc.text('Financial Health Score', 20, yPos);
  doc.setFontSize(24);
  doc.setTextColor(
    data.healthScore >= 80 ? 34 : data.healthScore >= 60 ? 59 : data.healthScore >= 40 ? 234 : 220,
    data.healthScore >= 80 ? 197 : data.healthScore >= 60 ? 130 : data.healthScore >= 40 ? 179 : 38,
    data.healthScore >= 80 ? 94 : data.healthScore >= 60 ? 246 : data.healthScore >= 40 ? 8 : 38
  );
  doc.text(`${data.healthScore}/100`, 150, yPos);
  doc.setTextColor(0, 0, 0);
  yPos += 15;

  // ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
  doc.setFontSize(14);
  doc.text('Main Results:', 20, yPos);
  yPos += 10;

  doc.setFontSize(11);
  const results = [
    `Total Debt: ${formatCurrency(data.totalDebt)}`,
    `Interest Rate: ${data.interestRate}%`,
    `Monthly Payment: ${formatCurrency(data.monthlyPayment)}`,
    `Payoff Period: ${data.years} years ${data.remainingMonths} months`,
    `Total to Pay: ${formatCurrency(data.totalPaid)}`,
    `Total Interest: ${formatCurrency(data.totalInterest)}`,
  ];

  results.forEach((result) => {
    doc.text(result, 25, yPos);
    yPos += 7;
  });

  yPos += 10;

  // ÿßŸÑÿ™ŸàÿµŸäÿßÿ™
  if (data.recommendations.length > 0) {
    doc.setFontSize(14);
    doc.text('Smart Recommendations:', 20, yPos);
    yPos += 10;

    data.recommendations.slice(0, 3).forEach((rec, index) => {
      doc.setFontSize(12);
      doc.setFont('helvetica', 'bold');
      doc.text(`${index + 1}. ${rec.title}`, 25, yPos);
      doc.setFont('helvetica', 'normal');
      yPos += 7;

      doc.setFontSize(10);
      doc.text(rec.description, 30, yPos);
      yPos += 6;

      rec.benefits.slice(0, 2).forEach((benefit) => {
        const cleanBenefit = benefit.replace(/[‚ú®‚è∞üí™üìàüèÉ‚úÖ]/g, '').trim();
        doc.text(`- ${cleanBenefit}`, 35, yPos);
        yPos += 5;
      });

      yPos += 5;

      // ÿµŸÅÿ≠ÿ© ÿ¨ÿØŸäÿØÿ© ÿ•ÿ∞ÿß ÿßŸÇÿ™ÿ±ÿ®ŸÜÿß ŸÖŸÜ ÿßŸÑŸÜŸáÿßŸäÿ©
      if (yPos > 250) {
        doc.addPage();
        yPos = 20;
      }
    });
  }

  // ÿµŸÅÿ≠ÿ© ÿ¨ÿØŸäÿØÿ© ŸÑŸÑŸÖÿ≠ÿßŸÉÿßÿ©
  if (data.simulations.length > 0 && yPos > 200) {
    doc.addPage();
    yPos = 20;
  }

  // ÿßŸÑÿ≥ŸäŸÜÿßÿ±ŸäŸàŸáÿßÿ™
  if (data.simulations.length > 0) {
    yPos += 10;
    doc.setFontSize(14);
    doc.text('Payment Scenarios:', 20, yPos);
    yPos += 10;

    data.simulations.forEach((sim, index) => {
      doc.setFontSize(11);
      doc.text(
        `Scenario ${index + 1}: ${formatCurrency(sim.payment)}/month ‚Üí Save ${formatCurrency(sim.savings)} (${sim.monthsSaved} months faster)`,
        25,
        yPos
      );
      yPos += 8;
    });
  }

  // Footer ŸÅŸä ŸÉŸÑ ÿµŸÅÿ≠ÿ©
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFontSize(9);
    doc.setTextColor(128, 128, 128);
    doc.text(`Generated by Acash.ai - Page ${i} of ${pageCount}`, 105, 285, { align: 'center' });
    doc.text(new Date().toLocaleDateString('en-US'), 190, 285, { align: 'right' });
  }

  // ÿ™ŸÜÿ≤ŸäŸÑ ÿßŸÑŸÖŸÑŸÅ
  doc.save(`debt-report-${new Date().getTime()}.pdf`);
};

// ==========================================
// BUDGET CALCULATOR PDF
// ==========================================

export const generateBudgetPDF = (data: BudgetReportData) => {
  const doc = new jsPDF();
  const brandColor = [0, 102, 204]; // #0066CC
  const successColor = [0, 168, 107]; // #00A86B

  let yPos = 20;

  // Header with Branding
  doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
  doc.rect(0, 0, 210, 40, 'F');

  doc.setTextColor(255, 255, 255);
  doc.setFontSize(24);
  doc.text('Acash.ai', 105, 20, { align: 'center' });

  doc.setFontSize(16);
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ© ÿßŸÑÿ¥ÿÆÿµŸäÿ©', 105, 32, { align: 'center' });

  // Reset colors
  doc.setTextColor(0, 0, 0);
  yPos = 50;

  // Report Date
  doc.setFontSize(10);
  doc.setTextColor(128, 128, 128);
  doc.text(`ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±: ${new Date().toLocaleDateString('ar-SA')}`, 20, yPos);
  yPos += 15;

  // Health Score Section
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text('ÿØÿ±ÿ¨ÿ© ÿßŸÑÿµÿ≠ÿ© ÿßŸÑŸÖÿßŸÑŸäÿ©', 20, yPos);
  yPos += 10;

  // Health score box
  const scoreColor =
    data.healthScore >= 80
      ? [34, 197, 94] // green
      : data.healthScore >= 60
        ? [59, 130, 246] // blue
        : data.healthScore >= 40
          ? [234, 179, 8] // yellow
          : [220, 38, 38]; // red

  doc.setFillColor(scoreColor[0], scoreColor[1], scoreColor[2], 0.1);
  doc.roundedRect(20, yPos, 170, 30, 5, 5, 'F');
  doc.setTextColor(scoreColor[0], scoreColor[1], scoreColor[2]);
  doc.setFontSize(36);
  doc.text(`${data.healthScore}/100`, 105, yPos + 20, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos += 40;

  // Main Results Section
  doc.setFontSize(14);
  doc.text('ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ©', 20, yPos);
  yPos += 10;

  const results = [
    { label: 'ÿßŸÑÿØÿÆŸÑ ÿßŸÑÿ¥Ÿáÿ±Ÿä', value: formatCurrency(data.monthlyIncome), color: [34, 197, 94] },
    {
      label: 'ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™ ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ©',
      value: formatCurrency(data.monthlyExpenses),
      color: [234, 88, 12],
    },
    {
      label: 'ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑÿ¥Ÿáÿ±Ÿä',
      value: formatCurrency(Math.abs(data.balance)),
      color: data.balance >= 0 ? [34, 197, 94] : [220, 38, 38],
    },
    { label: 'ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿßÿØÿÆÿßÿ±', value: `${data.savingsRate.toFixed(1)}%`, color: [59, 130, 246] },
  ];

  results.forEach((result) => {
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(result.label, 25, yPos + 10);

    doc.setTextColor(result.color[0], result.color[1], result.color[2]);
    doc.setFont('helvetica', 'bold');
    doc.text(result.value, 185, yPos + 10, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 18;
  });

  // Status Section
  yPos += 5;
  doc.setFontSize(14);
  doc.setTextColor(0, 0, 0);
  doc.text('ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ©', 20, yPos);
  yPos += 10;

  const statusText =
    data.status === 'surplus'
      ? 'ŸÅÿßÿ¶ÿ∂ - Ÿàÿ∂ÿπ ŸÖŸÖÿ™ÿßÿ≤'
      : data.status === 'balanced'
        ? 'ŸÖÿ™Ÿàÿßÿ≤ŸÜ - Ÿäÿ≠ÿ™ÿßÿ¨ ÿ™ÿ≠ÿ≥ŸäŸÜ'
        : 'ÿπÿ¨ÿ≤ - Ÿäÿ≠ÿ™ÿßÿ¨ ÿ•ÿ¨ÿ±ÿßÿ° ŸÅŸàÿ±Ÿä';

  const statusColor =
    data.status === 'surplus'
      ? [34, 197, 94]
      : data.status === 'balanced'
        ? [234, 179, 8]
        : [220, 38, 38];

  doc.setFillColor(statusColor[0], statusColor[1], statusColor[2], 0.1);
  doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');
  doc.setTextColor(statusColor[0], statusColor[1], statusColor[2]);
  doc.setFont('helvetica', 'bold');
  doc.setFontSize(12);
  doc.text(statusText, 105, yPos + 10, { align: 'center' });
  doc.setFont('helvetica', 'normal');

  yPos += 25;

  // New page for recommendations
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  // Recommendations Section
  if (data.recommendations.length > 0) {
    doc.setFontSize(14);
    doc.setTextColor(0, 0, 0);
    doc.text('ÿ™ŸàÿµŸäÿßÿ™ ÿ∞ŸÉŸäÿ© ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸäÿ≤ÿßŸÜŸäÿ™ŸÉ', 20, yPos);
    yPos += 10;

    data.recommendations.slice(0, 3).forEach((rec, index) => {
      if (yPos > 250) {
        doc.addPage();
        yPos = 20;
      }

      doc.setFillColor(249, 250, 251);
      doc.roundedRect(20, yPos, 170, 8, 2, 2, 'F');

      doc.setFontSize(11);
      doc.setFont('helvetica', 'bold');
      doc.text(`${index + 1}. ${rec.title}`, 25, yPos + 6);
      doc.setFont('helvetica', 'normal');
      yPos += 10;

      doc.setFontSize(9);
      rec.benefits.slice(0, 3).forEach((benefit) => {
        const cleanBenefit = benefit.replace(/[‚úÖüí∞üìàüéØ‚ö°]/g, '').trim();
        const lines = doc.splitTextToSize(cleanBenefit, 160);
        doc.text(lines, 30, yPos);
        yPos += lines.length * 5;
      });

      yPos += 8;
    });
  }

  // Quick Tips Section
  yPos += 10;
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  doc.setFontSize(14);
  doc.text('ŸÜÿµÿßÿ¶ÿ≠ ÿ≥ÿ±Ÿäÿπÿ©', 20, yPos);
  yPos += 10;

  const tips = [
    'ŸÇÿßÿπÿØÿ© 50/30/20: 50% ÿ∂ÿ±Ÿàÿ±Ÿäÿßÿ™ÿå 30% ÿ±ÿ∫ÿ®ÿßÿ™ÿå 20% ÿßÿØÿÆÿßÿ±',
    'ÿ±ÿßÿ¨ÿπ ŸÖÿµÿ±ŸàŸÅÿßÿ™ŸÉ ŸäŸàŸÖŸäÿßŸã ŸÑŸÖÿØÿ© ÿ¥Ÿáÿ± ŸÑÿßŸÉÿ™ÿ¥ÿßŸÅ ŸÜŸÇÿßÿ∑ ÿßŸÑŸáÿØÿ±',
    'ÿßÿ®ÿØÿ£ ÿ®ÿßÿØÿÆÿßÿ± 3-6 ÿ£ÿ¥Ÿáÿ± ŸÖŸÜ ŸÖÿµÿ±ŸàŸÅÿßÿ™ŸÉ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©',
    'ÿ£ÿ™ŸÖÿ™ÿ© ÿßŸÑÿßÿØÿÆÿßÿ±: ÿ≠ŸàŸÑ ŸÖÿ®ŸÑÿ∫ ÿ´ÿßÿ®ÿ™ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ŸÅŸä ÿ®ÿØÿßŸäÿ© ŸÉŸÑ ÿ¥Ÿáÿ±',
  ];

  doc.setFontSize(10);
  tips.forEach((tip) => {
    const lines = doc.splitTextToSize(tip, 165);
    doc.text(lines, 25, yPos);
    yPos += lines.length * 5 + 3;
  });

  // Footer on all pages
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(0, 282, 210, 15, 'F');

    doc.setFontSize(9);
    doc.setTextColor(255, 255, 255);
    doc.text('Powered by Acash.ai - Your Financial Intelligence Partner', 105, 290, {
      align: 'center',
    });
  }

  // Save PDF
  doc.save(`acash-budget-${new Date().getTime()}.pdf`);
};

// ==========================================
// LOAN CALCULATOR PDF
// ==========================================

export const generateLoanPDF = (data: LoanReportData) => {
  const doc = new jsPDF();
  const brandColor = [0, 102, 204]; // #0066CC

  let yPos = 20;

  // Header with Branding
  doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
  doc.rect(0, 0, 210, 40, 'F');

  doc.setTextColor(255, 255, 255);
  doc.setFontSize(24);
  doc.text('Acash.ai', 105, 20, { align: 'center' });

  doc.setFontSize(16);
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑŸÇÿ±ÿ∂ ÿßŸÑŸÖŸÅÿµŸÑ', 105, 32, { align: 'center' });

  // Reset colors
  doc.setTextColor(0, 0, 0);
  yPos = 50;

  // Report Date
  doc.setFontSize(10);
  doc.setTextColor(128, 128, 128);
  doc.text(`ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±: ${new Date().toLocaleDateString('ar-SA')}`, 20, yPos);
  yPos += 15;

  // Loan Summary Section
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text('ŸÖŸÑÿÆÿµ ÿßŸÑŸÇÿ±ÿ∂', 20, yPos);
  yPos += 10;

  const loanSummary = [
    { label: 'ŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÇÿ±ÿ∂', value: formatCurrency(data.principal), color: [59, 130, 246] },
    {
      label: 'ŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÅÿßÿ¶ÿØÿ© ÿßŸÑÿ≥ŸÜŸàŸäÿ©',
      value: `${data.interestRate.toFixed(2)}%`,
      color: [234, 88, 12],
    },
    {
      label: 'ŸÖÿØÿ© ÿßŸÑŸÇÿ±ÿ∂',
      value: `${data.termYears} ${data.termYears === 1 ? 'ÿ≥ŸÜÿ©' : 'ÿ≥ŸÜŸàÿßÿ™'}`,
      color: [107, 114, 128],
    },
    {
      label: 'ÿßŸÑÿØŸÅÿπÿ© ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ©',
      value: formatCurrency(data.monthlyPayment),
      color: [34, 197, 94],
    },
    {
      label: 'ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿØŸÅŸàÿπ',
      value: formatCurrency(data.totalPayment),
      color: [147, 51, 234],
    },
    { label: 'ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÅŸàÿßÿ¶ÿØ', value: formatCurrency(data.totalInterest), color: [220, 38, 38] },
  ];

  loanSummary.forEach((item) => {
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(item.label, 25, yPos + 10);

    doc.setTextColor(item.color[0], item.color[1], item.color[2]);
    doc.setFont('helvetica', 'bold');
    doc.text(item.value, 185, yPos + 10, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 18;
  });

  yPos += 10;

  // Interest Breakdown
  doc.setFontSize(14);
  doc.setTextColor(0, 0, 0);
  doc.text('ÿ™ÿ≠ŸÑŸäŸÑ ÿßŸÑŸÅŸàÿßÿ¶ÿØ', 20, yPos);
  yPos += 10;

  const interestPercentage = ((data.totalInterest / data.principal) * 100).toFixed(1);
  doc.setFontSize(11);
  doc.text(
    `ÿ≥ÿ™ÿØŸÅÿπ ${formatCurrency(data.totalInterest)} ŸÉŸÅŸàÿßÿ¶ÿØÿå ŸàŸáŸà ${interestPercentage}% ŸÖŸÜ ŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÇÿ±ÿ∂ ÿßŸÑÿ£ÿµŸÑŸä.`,
    25,
    yPos
  );
  yPos += 10;

  const principalPercentage = ((data.principal / data.totalPayment) * 100).toFixed(1);
  doc.text(
    `ŸÖŸÜ ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØŸÅŸàÿπ ${formatCurrency(data.totalPayment)}ÿå ${principalPercentage}% ŸáŸà ÿ£ÿµŸÑ ÿßŸÑŸÇÿ±ÿ∂ Ÿà ${(100 - parseFloat(principalPercentage)).toFixed(1)}% ŸÅŸàÿßÿ¶ÿØ.`,
    25,
    yPos
  );
  yPos += 15;

  // Amortization Schedule (if provided)
  if (data.amortizationSchedule && data.amortizationSchedule.length > 0) {
    if (yPos > 200) {
      doc.addPage();
      yPos = 20;
    }

    doc.setFontSize(14);
    doc.text('ÿ¨ÿØŸàŸÑ ÿßŸÑÿ≥ÿØÿßÿØ (ÿ£ŸàŸÑ 12 ÿ¥Ÿáÿ±)', 20, yPos);
    yPos += 10;

    // Table header
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(20, yPos, 170, 10, 'F');

    doc.setTextColor(255, 255, 255);
    doc.setFontSize(9);
    doc.text('ÿßŸÑÿ¥Ÿáÿ±', 25, yPos + 7);
    doc.text('ÿßŸÑÿØŸÅÿπÿ©', 60, yPos + 7);
    doc.text('ÿßŸÑÿ£ÿµŸÑ', 95, yPos + 7);
    doc.text('ÿßŸÑŸÅÿßÿ¶ÿØÿ©', 125, yPos + 7);
    doc.text('ÿßŸÑÿ±ÿµŸäÿØ', 160, yPos + 7);

    yPos += 12;
    doc.setTextColor(0, 0, 0);

    // Table rows (first 12 months)
    data.amortizationSchedule.slice(0, 12).forEach((row, index) => {
      if (yPos > 270) {
        doc.addPage();
        yPos = 20;
      }

      const bgColor = index % 2 === 0 ? 249 : 255;
      doc.setFillColor(bgColor, bgColor, bgColor);
      doc.rect(20, yPos - 5, 170, 8, 'F');

      doc.setFontSize(8);
      doc.text(row.month.toString(), 25, yPos);
      doc.text(formatCurrency(row.payment), 60, yPos);
      doc.text(formatCurrency(row.principal), 95, yPos);
      doc.text(formatCurrency(row.interest), 125, yPos);
      doc.text(formatCurrency(row.balance), 160, yPos);

      yPos += 8;
    });
  }

  // Tips Section
  yPos += 15;
  if (yPos > 230) {
    doc.addPage();
    yPos = 20;
  }

  doc.setFontSize(14);
  doc.text('ŸÜÿµÿßÿ¶ÿ≠ ŸÑÿ™ŸàŸÅŸäÿ± ÿßŸÑŸÖÿßŸÑ', 20, yPos);
  yPos += 10;

  const loanTips = [
    'ÿØŸÅÿπÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©: ÿ£Ÿä ŸÖÿ®ŸÑÿ∫ ÿ•ÿ∂ÿßŸÅŸä Ÿäÿ∞Ÿáÿ® ŸÖÿ®ÿßÿ¥ÿ±ÿ© ŸÑÿ£ÿµŸÑ ÿßŸÑŸÇÿ±ÿ∂ ŸàŸäŸàŸÅÿ± ÿ¢ŸÑÿßŸÅ ÿßŸÑÿ±ŸäÿßŸÑÿßÿ™ ŸÖŸÜ ÿßŸÑŸÅŸàÿßÿ¶ÿØ',
    'ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ŸÖŸàŸäŸÑ: ÿ•ÿ∞ÿß ÿ™ÿ≠ÿ≥ŸÜ Ÿàÿ∂ÿπŸÉ ÿßŸÑŸÖÿßŸÑŸäÿå ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ŸÇÿ±ÿ∂ ÿ®ŸÅÿßÿ¶ÿØÿ© ÿ£ŸÇŸÑ',
    'ÿØŸÅÿπ ŸÉŸÑ ÿ£ÿ≥ÿ®ŸàÿπŸäŸÜ: ÿ®ÿØŸÑÿßŸã ŸÖŸÜ ŸÖÿ±ÿ© ÿ¥Ÿáÿ±ŸäÿßŸãÿå ÿßÿØŸÅÿπ ŸÜÿµŸÅ ÿßŸÑŸÖÿ®ŸÑÿ∫ ŸÉŸÑ ÿ£ÿ≥ÿ®ŸàÿπŸäŸÜ ŸÑÿ™ŸàŸÅŸäÿ± ÿßŸÑŸÅŸàÿßÿ¶ÿØ',
    'ÿ™ÿ¨ŸÜÿ® ÿ™ÿ£ÿÆŸäÿ± ÿßŸÑÿØŸÅÿπÿßÿ™: ÿßŸÑÿ∫ÿ±ÿßŸÖÿßÿ™ ÿ™ÿ≤ŸäÿØ ŸÖŸÜ ÿ™ŸÉŸÑŸÅÿ© ÿßŸÑŸÇÿ±ÿ∂ ÿ®ÿ¥ŸÉŸÑ ŸÉÿ®Ÿäÿ±',
  ];

  doc.setFontSize(10);
  loanTips.forEach((tip) => {
    const lines = doc.splitTextToSize(tip, 165);
    doc.text(lines, 25, yPos);
    yPos += lines.length * 5 + 5;
  });

  // Footer on all pages
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(0, 282, 210, 15, 'F');

    doc.setFontSize(9);
    doc.setTextColor(255, 255, 255);
    doc.text('Powered by Acash.ai - Your Financial Intelligence Partner', 105, 290, {
      align: 'center',
    });
  }

  // Save PDF
  doc.save(`acash-loan-${new Date().getTime()}.pdf`);
};

// ==========================================
// SAVINGS GOAL CALCULATOR PDF
// ==========================================

interface SavingsReportData {
  goalAmount: number;
  currentSavings: number;
  monthlyContribution: number;
  monthsToGoal: number;
  totalToSave: number;
  feasibilityScore: number;
  status: string;
  recommendations: Array<{
    title: string;
    description: string;
    impact: string;
  }>;
}

export const generateSavingsPDF = (data: SavingsReportData) => {
  const doc = new jsPDF();
  const brandColor = [0, 102, 204]; // #0066CC

  let yPos = 20;

  // Header with Branding
  doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
  doc.rect(0, 0, 210, 40, 'F');

  doc.setTextColor(255, 255, 255);
  doc.setFontSize(24);
  doc.text('Acash.ai', 105, 20, { align: 'center' });

  doc.setFontSize(16);
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿÆÿ∑ÿ© ÿßŸÑÿßÿØÿÆÿßÿ±', 105, 32, { align: 'center' });

  // Reset colors
  doc.setTextColor(0, 0, 0);
  yPos = 50;

  // Report Date
  doc.setFontSize(10);
  doc.setTextColor(128, 128, 128);
  doc.text(`ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±: ${new Date().toLocaleDateString('ar-SA')}`, 20, yPos);
  yPos += 15;

  // Feasibility Score Section
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text('ÿØÿ±ÿ¨ÿ© ÿ¨ÿØŸàŸâ ÿßŸÑÿÆÿ∑ÿ©', 20, yPos);
  yPos += 10;

  const scoreColor =
    data.feasibilityScore >= 80
      ? [34, 197, 94]
      : data.feasibilityScore >= 60
        ? [59, 130, 246]
        : data.feasibilityScore >= 40
          ? [234, 179, 8]
          : [220, 38, 38];

  doc.setFillColor(scoreColor[0], scoreColor[1], scoreColor[2], 0.1);
  doc.roundedRect(20, yPos, 170, 30, 5, 5, 'F');
  doc.setTextColor(scoreColor[0], scoreColor[1], scoreColor[2]);
  doc.setFontSize(36);
  doc.text(`${data.feasibilityScore}/100`, 105, yPos + 20, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos += 40;

  // Main Results Section
  doc.setFontSize(14);
  doc.text('ŸÖŸÑÿÆÿµ ÿÆÿ∑ÿ© ÿßŸÑÿßÿØÿÆÿßÿ±', 20, yPos);
  yPos += 10;

  const results = [
    { label: 'ŸáÿØŸÅ ÿßŸÑÿßÿØÿÆÿßÿ±', value: formatCurrency(data.goalAmount), color: [59, 130, 246] },
    {
      label: 'ÿßŸÑŸÖÿØÿÆÿ±ÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©',
      value: formatCurrency(data.currentSavings),
      color: [34, 197, 94],
    },
    {
      label: 'ÿßŸÑÿßÿØÿÆÿßÿ± ÿßŸÑÿ¥Ÿáÿ±Ÿä',
      value: formatCurrency(data.monthlyContribution),
      color: [147, 51, 234],
    },
    {
      label: 'ÿßŸÑŸÅÿ™ÿ±ÿ© ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©',
      value: `${data.monthsToGoal} ÿ¥Ÿáÿ±`,
      color: [234, 88, 12],
    },
    {
      label: 'ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä',
      value: formatCurrency(data.totalToSave),
      color: [220, 38, 38],
    },
  ];

  results.forEach((result) => {
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(result.label, 25, yPos + 10);

    doc.setTextColor(result.color[0], result.color[1], result.color[2]);
    doc.setFont('helvetica', 'bold');
    doc.text(result.value, 185, yPos + 10, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 18;
  });

  yPos += 10;

  // New page for recommendations
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  // Recommendations Section
  if (data.recommendations.length > 0) {
    doc.setFontSize(14);
    doc.setTextColor(0, 0, 0);
    doc.text('ÿ™ŸàÿµŸäÿßÿ™ ŸÑÿ™ÿ≠ŸÇŸäŸÇ ÿßŸÑŸáÿØŸÅ', 20, yPos);
    yPos += 10;

    data.recommendations.slice(0, 3).forEach((rec, index) => {
      if (yPos > 250) {
        doc.addPage();
        yPos = 20;
      }

      doc.setFillColor(249, 250, 251);
      doc.roundedRect(20, yPos, 170, 8, 2, 2, 'F');

      doc.setFontSize(11);
      doc.setFont('helvetica', 'bold');
      doc.text(`${index + 1}. ${rec.title}`, 25, yPos + 6);
      doc.setFont('helvetica', 'normal');
      yPos += 10;

      doc.setFontSize(9);
      const lines = doc.splitTextToSize(rec.description, 160);
      doc.text(lines, 30, yPos);
      yPos += lines.length * 5 + 8;
    });
  }

  // Quick Tips
  yPos += 10;
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  doc.setFontSize(14);
  doc.text('ŸÜÿµÿßÿ¶ÿ≠ ÿ≥ÿ±Ÿäÿπÿ©', 20, yPos);
  yPos += 10;

  const tips = [
    'ÿ£ÿ™ŸÖÿ™ ÿßŸÑÿßÿØÿÆÿßÿ±: ÿ≠ŸàŸÑ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ŸÅŸä ÿ®ÿØÿßŸäÿ© ŸÉŸÑ ÿ¥Ÿáÿ±',
    'ÿßÿ≠ŸÅÿ∏ ÿßŸÑŸÖÿØÿÆÿ±ÿßÿ™ ŸÅŸä ÿ≠ÿ≥ÿßÿ® ŸÖŸÜŸÅÿµŸÑ ŸÑÿ™ÿ¨ŸÜÿ® ÿ•ÿ∫ÿ±ÿßÿ° ÿßŸÑÿ•ŸÜŸÅÿßŸÇ',
    'ÿ±ÿßÿ¨ÿπ ÿ™ŸÇÿØŸÖŸÉ ŸÉŸÑ 3 ÿ£ÿ¥Ÿáÿ± ŸàÿπÿØŸëŸÑ ÿßŸÑÿÆÿ∑ÿ© ÿπŸÜÿØ ÿßŸÑÿ≠ÿßÿ¨ÿ©',
    'ÿßÿ≠ÿ™ŸÅŸÑ ÿ®ÿßŸÑÿ•ŸÜÿ¨ÿßÿ≤ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ŸÑŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ ÿßŸÑÿ≠ŸÖÿßÿ≥',
  ];

  doc.setFontSize(10);
  tips.forEach((tip) => {
    const lines = doc.splitTextToSize(tip, 165);
    doc.text(lines, 25, yPos);
    yPos += lines.length * 5 + 3;
  });

  // Footer on all pages
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(0, 282, 210, 15, 'F');

    doc.setFontSize(9);
    doc.setTextColor(255, 255, 255);
    doc.text('Powered by Acash.ai - Your Financial Intelligence Partner', 105, 290, {
      align: 'center',
    });
  }

  // Save PDF
  doc.save(`acash-savings-${new Date().getTime()}.pdf`);
};

// ==========================================
// EMERGENCY FUND CALCULATOR PDF
// ==========================================

interface EmergencyReportData {
  monthlyExpenses: number;
  targetAmount: number;
  currentSavings: number;
  monthsNeeded: number;
  monthlySavings: number;
  healthScore: number;
  status: string;
  recommendations: Array<{
    title: string;
    impact: string;
    benefits: string[];
  }>;
}

export const generateEmergencyPDF = (data: EmergencyReportData) => {
  const doc = new jsPDF();
  const brandColor = [0, 102, 204];

  let yPos = 20;

  // Header
  doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
  doc.rect(0, 0, 210, 40, 'F');

  doc.setTextColor(255, 255, 255);
  doc.setFontSize(24);
  doc.text('Acash.ai', 105, 20, { align: 'center' });

  doc.setFontSize(16);
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿµŸÜÿØŸàŸÇ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶', 105, 32, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos = 50;

  // Report Date
  doc.setFontSize(10);
  doc.setTextColor(128, 128, 128);
  doc.text(`ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±: ${new Date().toLocaleDateString('ar-SA')}`, 20, yPos);
  yPos += 15;

  // Health Score
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text('ÿØÿ±ÿ¨ÿ© ÿßŸÑÿ£ŸÖÿßŸÜ ÿßŸÑŸÖÿßŸÑŸä', 20, yPos);
  yPos += 10;

  const scoreColor =
    data.healthScore >= 80
      ? [34, 197, 94]
      : data.healthScore >= 60
        ? [59, 130, 246]
        : data.healthScore >= 40
          ? [234, 179, 8]
          : [220, 38, 38];

  doc.setFillColor(scoreColor[0], scoreColor[1], scoreColor[2], 0.1);
  doc.roundedRect(20, yPos, 170, 30, 5, 5, 'F');
  doc.setTextColor(scoreColor[0], scoreColor[1], scoreColor[2]);
  doc.setFontSize(36);
  doc.text(`${data.healthScore}/100`, 105, yPos + 20, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos += 40;

  // Main Results
  doc.setFontSize(14);
  doc.text('ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑ', 20, yPos);
  yPos += 10;

  const results = [
    { label: 'ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ≥ÿ™ŸáÿØŸÅ', value: formatCurrency(data.targetAmount), color: [59, 130, 246] },
    {
      label: 'ÿßŸÑŸÖÿØÿÆÿ±ÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©',
      value: formatCurrency(data.currentSavings),
      color: [34, 197, 94],
    },
    {
      label: 'ÿßŸÑÿ™ŸÇÿØŸÖ',
      value: `${Math.round((data.currentSavings / data.targetAmount) * 100)}%`,
      color: [147, 51, 234],
    },
    {
      label: 'ÿßŸÑÿßÿØÿÆÿßÿ± ÿßŸÑÿ¥Ÿáÿ±Ÿä ÿßŸÑŸÖŸÇÿ™ÿ±ÿ≠',
      value: formatCurrency(data.monthlySavings),
      color: [234, 88, 12],
    },
    { label: 'ÿßŸÑŸÖÿØÿ© ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ©', value: `${data.monthsNeeded} ÿ¥Ÿáÿ±`, color: [220, 38, 38] },
  ];

  results.forEach((result) => {
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(result.label, 25, yPos + 10);

    doc.setTextColor(result.color[0], result.color[1], result.color[2]);
    doc.setFont('helvetica', 'bold');
    doc.text(result.value, 185, yPos + 10, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 18;
  });

  yPos += 10;

  // Recommendations
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  if (data.recommendations.length > 0) {
    doc.setFontSize(14);
    doc.setTextColor(0, 0, 0);
    doc.text('ÿ™ŸàÿµŸäÿßÿ™ ÿ∞ŸÉŸäÿ©', 20, yPos);
    yPos += 10;

    data.recommendations.slice(0, 3).forEach((rec, index) => {
      if (yPos > 250) {
        doc.addPage();
        yPos = 20;
      }

      doc.setFillColor(249, 250, 251);
      doc.roundedRect(20, yPos, 170, 8, 2, 2, 'F');

      doc.setFontSize(11);
      doc.setFont('helvetica', 'bold');
      doc.text(`${index + 1}. ${rec.title}`, 25, yPos + 6);
      doc.setFont('helvetica', 'normal');
      yPos += 10;

      doc.setFontSize(9);
      rec.benefits.slice(0, 2).forEach((benefit) => {
        const lines = doc.splitTextToSize(benefit, 160);
        doc.text(lines, 30, yPos);
        yPos += lines.length * 5;
      });

      yPos += 5;
    });
  }

  // Tips
  yPos += 10;
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  doc.setFontSize(14);
  doc.text('ŸÜÿµÿßÿ¶ÿ≠ ŸÖŸáŸÖÿ©', 20, yPos);
  yPos += 10;

  const tips = [
    'ÿßÿ≠ŸÅÿ∏ ÿµŸÜÿØŸàŸÇ ÿßŸÑÿ∑Ÿàÿßÿ±ÿ¶ ŸÅŸä ÿ≠ÿ≥ÿßÿ® ŸÖŸÜŸÅÿµŸÑ ÿ≥ŸáŸÑ ÿßŸÑŸàÿµŸàŸÑ',
    'ŸÑÿß ÿ™ÿ≥ÿ™ÿÆÿØŸÖŸá ÿ•ŸÑÿß ŸÑŸÑÿ∑Ÿàÿßÿ±ÿ¶ ÿßŸÑÿ≠ŸÇŸäŸÇŸäÿ© ŸÅŸÇÿ∑',
    'ÿ±ÿßÿ¨ÿπ ÿßŸÑÿµŸÜÿØŸàŸÇ ŸÉŸÑ 6 ÿ£ÿ¥Ÿáÿ± Ÿàÿ≠ÿØŸëÿ´ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿ≠ÿ≥ÿ® ÿ™ÿ∫Ÿäÿ± ÿßŸÑŸÖÿµÿ±ŸàŸÅÿßÿ™',
    'ÿßÿ®ÿØÿ£ ÿ®ŸáÿØŸÅ ÿµÿ∫Ÿäÿ± (ÿ¥Ÿáÿ± Ÿàÿßÿ≠ÿØ) ÿ´ŸÖ Ÿàÿ≥Ÿëÿπ ÿ™ÿØÿ±Ÿäÿ¨ŸäÿßŸã',
  ];

  doc.setFontSize(10);
  tips.forEach((tip) => {
    const lines = doc.splitTextToSize(tip, 165);
    doc.text(lines, 25, yPos);
    yPos += lines.length * 5 + 3;
  });

  // Footer
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(0, 282, 210, 15, 'F');

    doc.setFontSize(9);
    doc.setTextColor(255, 255, 255);
    doc.text('Powered by Acash.ai - Your Financial Intelligence Partner', 105, 290, {
      align: 'center',
    });
  }

  doc.save(`acash-emergency-${new Date().getTime()}.pdf`);
};

// ==========================================
// ROI CALCULATOR PDF
// ==========================================

interface ROIReportData {
  initialInvestment: number;
  finalValue: number;
  timePeriod: number;
  roiPercentage: number;
  profit: number;
  annualizedReturn: number;
  status: string;
  recommendations: Array<{
    title: string;
    description: string;
    impact: string;
  }>;
}

export const generateROIPDF = (data: ROIReportData) => {
  const doc = new jsPDF();
  const brandColor = [0, 102, 204];

  let yPos = 20;

  // Header
  doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
  doc.rect(0, 0, 210, 40, 'F');

  doc.setTextColor(255, 255, 255);
  doc.setFontSize(24);
  doc.text('Acash.ai', 105, 20, { align: 'center' });

  doc.setFontSize(16);
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿßŸÑÿπÿßÿ¶ÿØ ÿπŸÑŸâ ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±', 105, 32, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos = 50;

  // Report Date
  doc.setFontSize(10);
  doc.setTextColor(128, 128, 128);
  doc.text(`ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±: ${new Date().toLocaleDateString('ar-SA')}`, 20, yPos);
  yPos += 15;

  // ROI Status
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text('ŸÜÿ™Ÿäÿ¨ÿ© ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±', 20, yPos);
  yPos += 10;

  const statusColor = data.profit >= 0 ? [34, 197, 94] : [220, 38, 38];
  const statusText = data.profit >= 0 ? 'ÿ±ÿ®ÿ≠' : 'ÿÆÿ≥ÿßÿ±ÿ©';

  doc.setFillColor(statusColor[0], statusColor[1], statusColor[2], 0.1);
  doc.roundedRect(20, yPos, 170, 30, 5, 5, 'F');
  doc.setTextColor(statusColor[0], statusColor[1], statusColor[2]);
  doc.setFontSize(32);
  doc.text(statusText, 105, yPos + 20, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos += 40;

  // Main Results
  doc.setFontSize(14);
  doc.text('ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±', 20, yPos);
  yPos += 10;

  const results = [
    {
      label: 'ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ± ÿßŸÑÿ£ŸàŸÑŸä',
      value: formatCurrency(data.initialInvestment),
      color: [59, 130, 246],
    },
    { label: 'ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑŸÜŸáÿßÿ¶Ÿäÿ©', value: formatCurrency(data.finalValue), color: [147, 51, 234] },
    {
      label: 'ÿßŸÑÿ±ÿ®ÿ≠/ÿßŸÑÿÆÿ≥ÿßÿ±ÿ©',
      value: formatCurrency(Math.abs(data.profit)),
      color: data.profit >= 0 ? [34, 197, 94] : [220, 38, 38],
    },
    {
      label: 'ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿπÿßÿ¶ÿØ',
      value: `${data.roiPercentage >= 0 ? '+' : ''}${data.roiPercentage.toFixed(2)}%`,
      color: data.roiPercentage >= 0 ? [34, 197, 94] : [220, 38, 38],
    },
    {
      label: 'ÿßŸÑÿπÿßÿ¶ÿØ ÿßŸÑÿ≥ŸÜŸàŸä ÿßŸÑŸÖÿ±ŸÉÿ®',
      value: `${data.annualizedReturn >= 0 ? '+' : ''}${data.annualizedReturn.toFixed(2)}%`,
      color: [234, 88, 12],
    },
    { label: 'ŸÅÿ™ÿ±ÿ© ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±', value: `${data.timePeriod} ÿ≥ŸÜŸàÿßÿ™`, color: [107, 114, 128] },
  ];

  results.forEach((result) => {
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(result.label, 25, yPos + 10);

    doc.setTextColor(result.color[0], result.color[1], result.color[2]);
    doc.setFont('helvetica', 'bold');
    doc.text(result.value, 185, yPos + 10, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 18;
  });

  yPos += 10;

  // Recommendations
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  if (data.recommendations.length > 0) {
    doc.setFontSize(14);
    doc.setTextColor(0, 0, 0);
    doc.text('ÿ™ŸàÿµŸäÿßÿ™ ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±Ÿäÿ©', 20, yPos);
    yPos += 10;

    data.recommendations.slice(0, 3).forEach((rec, index) => {
      if (yPos > 250) {
        doc.addPage();
        yPos = 20;
      }

      doc.setFillColor(249, 250, 251);
      doc.roundedRect(20, yPos, 170, 8, 2, 2, 'F');

      doc.setFontSize(11);
      doc.setFont('helvetica', 'bold');
      doc.text(`${index + 1}. ${rec.title}`, 25, yPos + 6);
      doc.setFont('helvetica', 'normal');
      yPos += 10;

      doc.setFontSize(9);
      const lines = doc.splitTextToSize(rec.description, 160);
      doc.text(lines, 30, yPos);
      yPos += lines.length * 5 + 8;
    });
  }

  // Investment Tips
  yPos += 10;
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  doc.setFontSize(14);
  doc.text('ŸÜÿµÿßÿ¶ÿ≠ ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±Ÿäÿ©', 20, yPos);
  yPos += 10;

  const tips = [
    'ŸÜŸàŸëÿπ ŸÖÿ≠ŸÅÿ∏ÿ™ŸÉ ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±Ÿäÿ© ŸÑÿ™ŸÇŸÑŸäŸÑ ÿßŸÑŸÖÿÆÿßÿ∑ÿ±',
    'ÿ±ÿßÿ¨ÿπ ÿ£ÿØÿßÿ° ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±ÿßÿ™ŸÉ ÿ®ÿ¥ŸÉŸÑ ÿØŸàÿ±Ÿä (ŸÉŸÑ 6 ÿ£ÿ¥Ÿáÿ± ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ)',
    'ŸÑÿß ÿ™ÿ≥ÿ™ÿ´ŸÖÿ± ÿ£ŸÖŸàÿßŸÑ ÿ™ÿ≠ÿ™ÿßÿ¨Ÿáÿß ŸÅŸä ÿßŸÑŸÖÿØŸâ ÿßŸÑŸÇÿµŸäÿ±',
    'ÿßÿ≥ÿ™ÿ´ŸÖÿ± ÿπŸÑŸâ ÿßŸÑŸÖÿØŸâ ÿßŸÑÿ∑ŸàŸäŸÑ ŸÑŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ÿßŸÑŸÅÿßÿ¶ÿØÿ© ÿßŸÑŸÖÿ±ŸÉÿ®ÿ©',
  ];

  doc.setFontSize(10);
  tips.forEach((tip) => {
    const lines = doc.splitTextToSize(tip, 165);
    doc.text(lines, 25, yPos);
    yPos += lines.length * 5 + 3;
  });

  // Footer
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(0, 282, 210, 15, 'F');

    doc.setFontSize(9);
    doc.setTextColor(255, 255, 255);
    doc.text('Powered by Acash.ai - Your Financial Intelligence Partner', 105, 290, {
      align: 'center',
    });
  }

  doc.save(`acash-roi-${new Date().getTime()}.pdf`);
};

// ==========================================
// RETIREMENT CALCULATOR PDF
// ==========================================

interface RetirementReportData {
  currentAge: number;
  retirementAge: number;
  currentSavings: number;
  monthlyContribution: number;
  yearsToRetirement: number;
  projectedFund: number;
  monthlyRetirementIncome: number;
  gap: number;
  feasibilityScore: number;
  status: string;
  recommendations: Array<{
    title: string;
    description: string;
    impact: string;
  }>;
}

export const generateRetirementPDF = (data: RetirementReportData) => {
  const doc = new jsPDF();
  const brandColor = [0, 102, 204];

  let yPos = 20;

  // Header
  doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
  doc.rect(0, 0, 210, 40, 'F');

  doc.setTextColor(255, 255, 255);
  doc.setFontSize(24);
  doc.text('Acash.ai', 105, 20, { align: 'center' });

  doc.setFontSize(16);
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿÆÿ∑ÿ© ÿßŸÑÿ™ŸÇÿßÿπÿØ', 105, 32, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos = 50;

  // Report Date
  doc.setFontSize(10);
  doc.setTextColor(128, 128, 128);
  doc.text(`ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±: ${new Date().toLocaleDateString('ar-SA')}`, 20, yPos);
  yPos += 15;

  // Feasibility Score
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text('ÿØÿ±ÿ¨ÿ© ÿ¨ÿØŸàŸâ ÿßŸÑÿÆÿ∑ÿ©', 20, yPos);
  yPos += 10;

  const scoreColor =
    data.feasibilityScore >= 80
      ? [34, 197, 94]
      : data.feasibilityScore >= 60
        ? [59, 130, 246]
        : data.feasibilityScore >= 40
          ? [234, 179, 8]
          : [220, 38, 38];

  doc.setFillColor(scoreColor[0], scoreColor[1], scoreColor[2], 0.1);
  doc.roundedRect(20, yPos, 170, 30, 5, 5, 'F');
  doc.setTextColor(scoreColor[0], scoreColor[1], scoreColor[2]);
  doc.setFontSize(36);
  doc.text(`${data.feasibilityScore}/100`, 105, yPos + 20, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos += 40;

  // Main Results
  doc.setFontSize(14);
  doc.text('ŸÖŸÑÿÆÿµ ÿÆÿ∑ÿ© ÿßŸÑÿ™ŸÇÿßÿπÿØ', 20, yPos);
  yPos += 10;

  const results = [
    { label: 'ÿßŸÑÿπŸÖÿ± ÿßŸÑÿ≠ÿßŸÑŸä', value: `${data.currentAge} ÿ≥ŸÜÿ©`, color: [107, 114, 128] },
    { label: 'ÿ≥ŸÜ ÿßŸÑÿ™ŸÇÿßÿπÿØ', value: `${data.retirementAge} ÿ≥ŸÜÿ©`, color: [107, 114, 128] },
    {
      label: 'ÿ≥ŸÜŸàÿßÿ™ ÿ≠ÿ™Ÿâ ÿßŸÑÿ™ŸÇÿßÿπÿØ',
      value: `${data.yearsToRetirement} ÿ≥ŸÜÿ©`,
      color: [234, 88, 12],
    },
    {
      label: 'ÿßŸÑŸÖÿØÿÆÿ±ÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©',
      value: formatCurrency(data.currentSavings),
      color: [34, 197, 94],
    },
    {
      label: 'ÿßŸÑÿßÿØÿÆÿßÿ± ÿßŸÑÿ¥Ÿáÿ±Ÿä',
      value: formatCurrency(data.monthlyContribution),
      color: [59, 130, 246],
    },
    {
      label: 'ÿßŸÑÿ±ÿµŸäÿØ ÿßŸÑÿ™ŸÇÿßÿπÿØŸä ÿßŸÑŸÖÿ™ŸàŸÇÿπ',
      value: formatCurrency(data.projectedFund),
      color: [147, 51, 234],
    },
    {
      label: 'ÿßŸÑÿØÿÆŸÑ ÿßŸÑÿ¥Ÿáÿ±Ÿä ÿßŸÑŸÖÿ™ŸàŸÇÿπ',
      value: formatCurrency(data.monthlyRetirementIncome),
      color: [34, 197, 94],
    },
  ];

  if (data.gap !== 0) {
    results.push({
      label: data.gap > 0 ? 'ÿßŸÑŸÅÿ¨Ÿàÿ© ÿßŸÑÿ™ŸÇÿßÿπÿØŸäÿ©' : 'ÿßŸÑŸÅÿßÿ¶ÿ∂ ÿßŸÑÿ™ŸÇÿßÿπÿØŸä',
      value: formatCurrency(Math.abs(data.gap)),
      color: data.gap > 0 ? [220, 38, 38] : [34, 197, 94],
    });
  }

  results.forEach((result) => {
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(result.label, 25, yPos + 10);

    doc.setTextColor(result.color[0], result.color[1], result.color[2]);
    doc.setFont('helvetica', 'bold');
    doc.text(result.value, 185, yPos + 10, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 18;
  });

  yPos += 10;

  // Recommendations
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  if (data.recommendations.length > 0) {
    doc.setFontSize(14);
    doc.setTextColor(0, 0, 0);
    doc.text('ÿ™ŸàÿµŸäÿßÿ™ ŸÑÿ™ÿ≠ÿ≥ŸäŸÜ ÿÆÿ∑ÿ© ÿßŸÑÿ™ŸÇÿßÿπÿØ', 20, yPos);
    yPos += 10;

    data.recommendations.slice(0, 3).forEach((rec, index) => {
      if (yPos > 250) {
        doc.addPage();
        yPos = 20;
      }

      doc.setFillColor(249, 250, 251);
      doc.roundedRect(20, yPos, 170, 8, 2, 2, 'F');

      doc.setFontSize(11);
      doc.setFont('helvetica', 'bold');
      doc.text(`${index + 1}. ${rec.title}`, 25, yPos + 6);
      doc.setFont('helvetica', 'normal');
      yPos += 10;

      doc.setFontSize(9);
      const lines = doc.splitTextToSize(rec.description, 160);
      doc.text(lines, 30, yPos);
      yPos += lines.length * 5 + 8;
    });
  }

  // Retirement Tips
  yPos += 10;
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  doc.setFontSize(14);
  doc.text('ŸÜÿµÿßÿ¶ÿ≠ ŸÑŸÑÿ™ŸÇÿßÿπÿØ ÿßŸÑŸÖÿ±Ÿäÿ≠', 20, yPos);
  yPos += 10;

  const tips = [
    'ÿßÿ®ÿØÿ£ ÿßŸÑÿßÿØÿÆÿßÿ± ŸÖÿ®ŸÉÿ±ÿßŸã ŸÑŸÑÿßÿ≥ÿ™ŸÅÿßÿØÿ© ŸÖŸÜ ÿßŸÑŸÅÿßÿ¶ÿØÿ© ÿßŸÑŸÖÿ±ŸÉÿ®ÿ©',
    'ÿ±ÿßÿ¨ÿπ ÿÆÿ∑ÿ© ÿßŸÑÿ™ŸÇÿßÿπÿØ ÿ≥ŸÜŸàŸäÿßŸã ŸàÿπÿØŸëŸÑŸáÿß ÿ≠ÿ≥ÿ® ÿ™ÿ∫Ÿäÿ± ÿßŸÑÿ∏ÿ±ŸàŸÅ',
    'ŸÜŸàŸëÿπ ŸÖÿµÿßÿØÿ± ÿßŸÑÿØÿÆŸÑ ÿßŸÑÿ™ŸÇÿßÿπÿØŸä (ŸÖÿØÿÆÿ±ÿßÿ™ÿå ÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±ÿßÿ™ÿå ÿπŸÇÿßÿ±ÿßÿ™)',
    'ÿßÿ≠ÿ≥ÿ® ÿ™ŸÉÿßŸÑŸäŸÅ ÿßŸÑÿ±ÿπÿßŸäÿ© ÿßŸÑÿµÿ≠Ÿäÿ© ÿ∂ŸÖŸÜ ÿÆÿ∑ÿ© ÿßŸÑÿ™ŸÇÿßÿπÿØ',
  ];

  doc.setFontSize(10);
  tips.forEach((tip) => {
    const lines = doc.splitTextToSize(tip, 165);
    doc.text(lines, 25, yPos);
    yPos += lines.length * 5 + 3;
  });

  // Footer
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(0, 282, 210, 15, 'F');

    doc.setFontSize(9);
    doc.setTextColor(255, 255, 255);
    doc.text('Powered by Acash.ai - Your Financial Intelligence Partner', 105, 290, {
      align: 'center',
    });
  }

  doc.save(`acash-retirement-${new Date().getTime()}.pdf`);
};

// ==========================================
// ZAKAT CALCULATOR PDF
// ==========================================

interface ZakatReportData {
  cash: number;
  gold: number;
  silver: number;
  investments: number;
  businessAssets: number;
  liabilities: number;
  totalWealth: number;
  zakatAmount: number;
  nisab: number;
}

export const generateZakatPDF = (data: ZakatReportData) => {
  const doc = new jsPDF();
  const brandColor = [0, 102, 204];

  let yPos = 20;

  // Header
  doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
  doc.rect(0, 0, 210, 40, 'F');

  doc.setTextColor(255, 255, 255);
  doc.setFontSize(24);
  doc.text('Acash.ai', 105, 20, { align: 'center' });

  doc.setFontSize(16);
  doc.text('ÿ™ŸÇÿ±Ÿäÿ± ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ≤ŸÉÿßÿ©', 105, 32, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos = 50;

  // Report Date
  doc.setFontSize(10);
  doc.setTextColor(128, 128, 128);
  doc.text(`ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±: ${new Date().toLocaleDateString('ar-SA')}`, 20, yPos);
  yPos += 15;

  // Zakat Amount
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text('ŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ≤ŸÉÿßÿ© ÿßŸÑŸàÿßÿ¨ÿ®', 20, yPos);
  yPos += 10;

  doc.setFillColor(34, 197, 94, 0.1);
  doc.roundedRect(20, yPos, 170, 35, 5, 5, 'F');
  doc.setTextColor(34, 197, 94);
  doc.setFontSize(40);
  doc.text(formatCurrency(data.zakatAmount), 105, yPos + 22, { align: 'center' });

  doc.setTextColor(0, 0, 0);
  yPos += 45;

  // Wealth Breakdown
  doc.setFontSize(14);
  doc.text('ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ´ÿ±Ÿàÿ©', 20, yPos);
  yPos += 10;

  const breakdown = [
    { label: 'ÿßŸÑŸÜŸÇÿØ ŸàÿßŸÑÿ≥ŸÜÿØÿßÿ™', value: formatCurrency(data.cash), color: [59, 130, 246] },
    { label: 'ŸÇŸäŸÖÿ© ÿßŸÑÿ∞Ÿáÿ®', value: formatCurrency(data.gold), color: [234, 179, 8] },
    { label: 'ŸÇŸäŸÖÿ© ÿßŸÑŸÅÿ∂ÿ©', value: formatCurrency(data.silver), color: [147, 197, 253] },
    { label: 'ÿßŸÑÿßÿ≥ÿ™ÿ´ŸÖÿßÿ±ÿßÿ™', value: formatCurrency(data.investments), color: [147, 51, 234] },
    { label: 'ÿ£ÿµŸàŸÑ ÿßŸÑÿπŸÖŸÑ', value: formatCurrency(data.businessAssets), color: [34, 197, 94] },
    { label: 'ÿßŸÑÿØŸäŸàŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿ≠ŸÇÿ©', value: formatCurrency(data.liabilities), color: [220, 38, 38] },
  ];

  breakdown.forEach((item) => {
    doc.setFillColor(240, 240, 240);
    doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(item.label, 25, yPos + 10);

    doc.setTextColor(item.color[0], item.color[1], item.color[2]);
    doc.setFont('helvetica', 'bold');
    doc.text(item.value, 185, yPos + 10, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 18;
  });

  yPos += 5;

  // Total Wealth
  doc.setFillColor(59, 130, 246, 0.1);
  doc.roundedRect(20, yPos, 170, 15, 3, 3, 'F');

  doc.setFontSize(12);
  doc.setTextColor(0, 0, 0);
  doc.setFont('helvetica', 'bold');
  doc.text('ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ´ÿ±Ÿàÿ©', 25, yPos + 10);

  doc.setTextColor(59, 130, 246);
  doc.text(formatCurrency(data.totalWealth), 185, yPos + 10, { align: 'right' });
  doc.setFont('helvetica', 'normal');

  yPos += 25;

  // Zakat Details
  doc.setFontSize(14);
  doc.setTextColor(0, 0, 0);
  doc.text('ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ≠ÿ≥ÿßÿ®', 20, yPos);
  yPos += 10;

  const details = [
    { label: 'ÿßŸÑŸÜÿµÿßÿ® (85 ÿ¨ÿ±ÿßŸÖ ÿ∞Ÿáÿ®)', value: formatCurrency(data.nisab) },
    { label: 'ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ≤ŸÉÿßÿ©', value: '2.5%' },
    {
      label: 'ÿ≠ÿßŸÑÿ© ÿßŸÑÿ≤ŸÉÿßÿ©',
      value: data.totalWealth >= data.nisab ? 'Ÿàÿßÿ¨ÿ®ÿ©' : 'ÿ∫Ÿäÿ± Ÿàÿßÿ¨ÿ®ÿ©',
    },
  ];

  details.forEach((item) => {
    doc.setFontSize(11);
    doc.setTextColor(80, 80, 80);
    doc.text(item.label, 25, yPos);

    doc.setTextColor(0, 0, 0);
    doc.setFont('helvetica', 'bold');
    doc.text(item.value, 185, yPos, { align: 'right' });
    doc.setFont('helvetica', 'normal');

    yPos += 8;
  });

  yPos += 15;

  // New page if needed
  if (yPos > 220) {
    doc.addPage();
    yPos = 20;
  }

  // Zakat Information
  doc.setFontSize(14);
  doc.text('ŸÖÿµÿßÿ±ŸÅ ÿßŸÑÿ≤ŸÉÿßÿ© ÿßŸÑÿ´ŸÖÿßŸÜŸäÿ©', 20, yPos);
  yPos += 10;

  const masarif = [
    'ÿßŸÑŸÅŸÇÿ±ÿßÿ° (ŸÖŸÜ ŸÑÿß ŸäŸÖŸÑŸÉ ŸÉŸÅÿßŸäÿ™Ÿá)',
    'ÿßŸÑŸÖÿ≥ÿßŸÉŸäŸÜ (ŸÖŸÜ ŸÑÿß ŸäŸÉŸÅŸäŸá ŸÖÿß ŸäŸÖŸÑŸÉ)',
    'ÿßŸÑÿπÿßŸÖŸÑŸàŸÜ ÿπŸÑŸäŸáÿß (ÿ¨ÿ®ÿßÿ© ÿßŸÑÿ≤ŸÉÿßÿ©)',
    'ÿßŸÑŸÖÿ§ŸÑŸÅÿ© ŸÇŸÑŸàÿ®ŸáŸÖ (ŸÑÿ™ÿ£ŸÑŸäŸÅ ŸÇŸÑŸàÿ®ŸáŸÖ ÿπŸÑŸâ ÿßŸÑÿ•ÿ≥ŸÑÿßŸÖ)',
    'ŸÅŸä ÿßŸÑÿ±ŸÇÿßÿ® (ÿ™ÿ≠ÿ±Ÿäÿ± ÿßŸÑÿπÿ®ŸäÿØ)',
    'ÿßŸÑÿ∫ÿßÿ±ŸÖŸàŸÜ (ÿßŸÑŸÖÿØŸäŸÜŸàŸÜ)',
    'ŸÅŸä ÿ≥ÿ®ŸäŸÑ ÿßŸÑŸÑŸá (ÿßŸÑÿ¨ŸáÿßÿØ ŸàÿßŸÑÿØÿπŸàÿ©)',
    'ÿßÿ®ŸÜ ÿßŸÑÿ≥ÿ®ŸäŸÑ (ÿßŸÑŸÖÿ≥ÿßŸÅÿ± ÿßŸÑŸÖÿ≠ÿ™ÿßÿ¨)',
  ];

  doc.setFontSize(10);
  masarif.forEach((masraf, index) => {
    doc.text(`${index + 1}. ${masraf}`, 25, yPos);
    yPos += 6;
  });

  yPos += 10;

  // Important Notes
  doc.setFontSize(14);
  doc.text('ÿ¥ÿ±Ÿàÿ∑ Ÿàÿ¨Ÿàÿ® ÿßŸÑÿ≤ŸÉÿßÿ©', 20, yPos);
  yPos += 10;

  const shurut = [
    'ÿ®ŸÑŸàÿ∫ ÿßŸÑŸÜÿµÿßÿ® (85 ÿ¨ÿ±ÿßŸÖ ÿ∞Ÿáÿ® ÿ£Ÿà ŸÖÿß ŸäÿπÿßÿØŸÑŸá)',
    'ÿ≠ŸàŸÑÿßŸÜ ÿßŸÑÿ≠ŸàŸÑ (ŸÖÿ±Ÿàÿ± ÿ≥ŸÜÿ© Ÿáÿ¨ÿ±Ÿäÿ© ŸÉÿßŸÖŸÑÿ©)',
    'ÿßŸÑŸÖŸÑŸÉ ÿßŸÑÿ™ÿßŸÖ ŸÑŸÑŸÖÿßŸÑ',
    'ŸÉŸàŸÜ ÿßŸÑŸÖÿßŸÑ ŸÜÿßŸÖŸäÿßŸã ÿ£Ÿà ŸÇÿßÿ®ŸÑÿßŸã ŸÑŸÑŸÜŸÖÿßÿ°',
    'ÿßŸÑŸÅÿ∂ŸÑ ÿπŸÜ ÿßŸÑÿ≠Ÿàÿßÿ¶ÿ¨ ÿßŸÑÿ£ÿµŸÑŸäÿ©',
  ];

  doc.setFontSize(10);
  shurut.forEach((shart) => {
    const lines = doc.splitTextToSize(`- ${shart}`, 165);
    doc.text(lines, 25, yPos);
    yPos += lines.length * 5 + 2;
  });

  // Footer
  const pageCount = doc.getNumberOfPages();
  for (let i = 1; i <= pageCount; i++) {
    doc.setPage(i);
    doc.setFillColor(brandColor[0], brandColor[1], brandColor[2]);
    doc.rect(0, 282, 210, 15, 'F');

    doc.setFontSize(9);
    doc.setTextColor(255, 255, 255);
    doc.text('Powered by Acash.ai - Your Financial Intelligence Partner', 105, 290, {
      align: 'center',
    });
  }

  doc.save(`acash-zakat-${new Date().getTime()}.pdf`);
};
